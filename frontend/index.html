<!doctype html>
<html lang="en">

<head>
  <meta charset="UTF-8" />
  <meta name="viewport" content="width=device-width, initial-scale=1.0" />
  <title>Clipmaker MVP</title>
  <link rel="stylesheet" href="/static/styles.css" />
</head>

<body>
  <main class="container">
    <header>
      <h1>Clipmaker MVP</h1>
      <p>Upload audio, generate scenes, and render a demo video.</p>
    </header>

    <div class="grid-layout">
      <div class="sidebar">
        <section class="panel">
          <h2>Project</h2>
          <div class="form-row compact">
            <select id="project-list" style="flex-grow: 1;">
              <option value="">Loading projects...</option>
            </select>
            <button id="open-project">Open</button>
          </div>
          <hr style="border: 0; border-top: 1px solid #e2e8f0; margin: 16px 0;">
          <h3 style="font-size: 1rem; margin-bottom: 12px; color: #475569;">Create New</h3>
          <div class="form-row compact">
            <label>Format <select id="format">
                <option value="9:16">9:16 (Story)</option>
                <option value="16:9">16:9 (Landscape)</option>
              </select></label>
            <label>Style <select id="style">
                <option value="cinematic">Cinematic</option>
                <option value="anime">Anime</option>
                <option value="illustration">Illustration</option>
                <option value="abstract">Abstract</option>
                <option value="cyberpunk">Cyberpunk</option>
                <option value="watercolor">Watercolor</option>
                <option value="horror">Horror / Dark</option>
                <option value="minimalist">Minimalist</option>
              </select></label>
          </div>
          <div class="form-row compact">
            <label class="checkbox"><input type="checkbox" id="subtitles" checked /> Subtitles</label>
          </div>
          <div class="form-row">
            <label style="display:block; margin-bottom:4px">Clip Idea / Narrative</label>
            <textarea id="user-description" rows="3"
              placeholder="Describe what happens in the video (e.g. 'A robot exploring a ruined city', 'Abstract shapes dancing to the beat')..."
              style="width:100%; resize: vertical; margin-bottom: 8px; border: 1px solid #e2e8f0; border-radius: 4px; padding: 8px;"></textarea>
          </div>
          <div class="form-row">
            <label style="display:block; margin-bottom:4px">Character Description</label>
            <textarea id="character-description" rows="2"
              placeholder="Describe the main character (e.g. 'Young woman with blue hair', 'A cute robot'). Leaves consistent across scenes."
              style="width:100%; resize: vertical; margin-bottom: 8px; border: 1px solid #e2e8f0; border-radius: 4px; padding: 8px;"></textarea>
          </div>
          <button id="create-project" style="width: 100%">Create Project</button>
          <div id="project-info" class="muted"></div>
        </section>

        <section class="panel">
          <h2>Audio</h2>
          <input type="file" id="audio-file" accept="audio/*" />
          <button id="upload-audio" style="margin-top: 10px; width: 100%">Upload</button>
          <div id="upload-status" class="muted"></div>
          <audio id="audio-player" controls style="width: 100%; margin-top: 10px; display: none;"></audio>
        </section>

        <section class="panel">
          <h2>Actions</h2>
          <button id="run-pipeline" style="width: 100%; margin-bottom: 10px;">Generate Scenes</button>
          <button id="render-project" style="width: 100%; margin-bottom: 10px;">Render Video</button>
          <button id="recalculate-timings" class="secondary-btn" style="width: 100%">Recalculate Timings</button>
          <div id="pipeline-progress-container" class="progress-container" style="display: none;">
            <div class="progress-label">Pipeline: <span id="pipeline-progress-pct">0</span>%</div>
            <div class="progress-bg">
              <div id="pipeline-progress-fill" class="progress-fill"></div>
            </div>
            <div id="pipeline-step" class="muted" style="font-size: 0.8rem; margin-top: 4px;"></div>
          </div>
          <div id="render-progress-container" class="progress-container" style="display: none;">
            <div class="progress-label">Rendering: <span id="render-progress-pct">0</span>%</div>
            <div class="progress-bg">
              <div id="render-progress-fill" class="progress-fill"></div>
            </div>
          </div>
          <div id="render-output" class="muted"></div>
        </section>

        <section class="panel" style="display:none;">
          <h2>Jobs Status</h2>
          <button id="refresh-jobs" class="secondary-btn" style="width:100%; margin-top:10px;">Refresh Status</button>
          <pre id="jobs-status" class="code-block"></pre>
        </section>
      </div>

      <div class="main-content">
        <div class="top-row">
          <section class="panel cinema-panel">
            <div id="preview-container" class="preview-box">
              <div id="preview-placeholder">
                <div class="placeholder-icon">ðŸŽ¬</div>
                <p>Preview will appear here</p>
              </div>
              <img id="preview-image" src="" style="display: none;" />
              <video id="preview-video" controls style="display: none;"></video>
            </div>
            <div class="timeline-wrapper">
              <div id="timeline-markers" class="timeline-markers"></div>
              <div id="timeline-progress" class="timeline-progress"></div>
            </div>
            <div class="preview-controls">
              <a id="download-video" class="button-link" href="#" download style="display: none;">Download Video</a>
            </div>
          </section>

          <section class="panel analysis-panel">
            <div style="display: flex; justify-content: space-between; align-items: center; margin-bottom: 15px;">
              <h2 style="margin: 0;">Analysis Data</h2>
              <button id="refresh-analysis" class="secondary-btn"
                style="padding: 6px 12px; font-size: 0.75rem;">Refresh</button>
            </div>
            <div id="analysis-content" class="analysis-scroll-area">
              <p class="muted">No analysis data loaded.</p>
            </div>
          </section>
        </div>

        <section class="panel" style="background: transparent; box-shadow: none; border: none; padding: 0;">
          <h2 style="margin-left: 10px; font-size: 1.5rem;">Scenes</h2>
          <div id="scenes" class="scenes" style="margin-top: 20px;"></div>
        </section>
      </div>
    </div>
  </main>
  <script src="/static/app.js?v=20240118_v2"></script>
</body>

</html>